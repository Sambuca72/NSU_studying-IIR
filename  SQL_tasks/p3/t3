SELECT DISTINCT M.COMPANY, COUNT(DISTINCT P.WARE), group_concat( P.WARE)

FROM MANUFACTURER M
LEFT JOIN PRODUCT P ON P.RECIPE_ID = M.RECIPE_ID 
GROUP BY M.COMPANY

ORDER BY COUNT(DISTINCT P.WARE) DESC
LIMIT 3