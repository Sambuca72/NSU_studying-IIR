SELECT M.COMPANY AS COMPANY, group_concat(DISTINCT P.RECIPE_ID), P.WARE
FROM MANUFACTURER M
LEFT JOIN PRODUCT P
    ON P.RECIPE_ID = M.RECIPE_ID
LEFT JOIN MATERIAL MA
    ON MA.RECIPE_ID = P.RECIPE_ID
GROUP BY M.COMPANY, P.WARE
HAVING count(DISTINCT P.RECIPE_ID) > 2
ORDER BY M.COMPANY ASC;