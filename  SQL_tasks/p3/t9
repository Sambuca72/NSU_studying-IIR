SELECT M.COMPANY AS COMPANY, group_concat(DISTINCT C1.CLASS) AS MATERIAL_CATEGORIES, group_concat(DISTINCT C2.CLASS) AS PRODUCT_CATEGORIES
FROM MANUFACTURER M
LEFT JOIN MATERIAL MA
	ON MA.RECIPE_ID = M.RECIPE_ID
INNER JOIN PRODUCT P
	ON P.RECIPE_ID = M.RECIPE_ID
LEFT JOIN CATEGORY C1
	ON C1.WARE = MA.WARE
LEFT JOIN CATEGORY C2 
	ON C2.WARE = P.WARE

ORDER BY COMPANY ASC;
GROUP BY COMPANY

--left for companies, that producing wares WITHOUT MATERIAL