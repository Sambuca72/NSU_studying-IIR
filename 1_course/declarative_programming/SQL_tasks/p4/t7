SELECT P.WARE, group_concat(DISTINCT MAT.WARE), BYS.RESULT AS BYPRODUCTS
	FROM PRODUCT P
LEFT JOIN MATERIAL MAT ON MAT.RECIPE_ID = P.RECIPE_ID
LEFT JOIN (SELECT P1.WARE, group_concat(DISTINCT P2.WARE) AS RESULT, P1.RECIPE_ID
		FROM PRODUCT P1
		JOIN PRODUCT P2 ON P1.RECIPE_ID = P2.RECIPE_ID
		WHERE P1.WARE <> P2.WARE
		GROUP BY P1.WARE) BYS ON BYS.WARE =  P.WARE
GROUP BY P.WARE
		