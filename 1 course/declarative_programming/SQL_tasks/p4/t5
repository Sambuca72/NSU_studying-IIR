SELECT DISTINCT COMPANY, CLASS, group_concat(DISTINCT PRODUCT.WARE)
FROM MANUFACTURER M, PRODUCT, CATEGORY C
WHERE PRODUCT.RECIPE_ID = M.RECIPE_ID
AND PRODUCT.WARE = C.WARE
AND NOT EXISTS (SELECT 1 FROM CATEGORY C1 WHERE C1.CLASS = C.CLASS 
				AND NOT EXISTS (SELECT 1 FROM PRODUCT, MANUFACTURER WHERE PRODUCT.RECIPE_ID = MANUFACTURER.RECIPE_ID 
								AND WARE = C1.WARE AND COMPANY = M.COMPANY))
GROUP BY COMPANY								
ORDER BY CLASS